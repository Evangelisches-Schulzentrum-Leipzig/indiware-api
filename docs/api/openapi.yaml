openapi: 3.1.0
info:
  title: Vertretungsplan API
  description: API for accessing school timetable data, substitution plans, and room availability information.
  contact:
    email: support@schulzentrum.de
  license:
    name: Open Source License 3.0
    url: https://opensource.org/license/osl-3-0
  version: 1.1.0
servers:
  - url: http://localhost:80
  - url: https://secure-gateway.schulzentrum.de/api/v1/timetable
tags:
  - name: metadata
    description: Metadata Endpoints
  - name: plan-daily
    description: Daily Timetable Plan Endpoints
  - name: plan-weekly
    description: Weekly Timetable Plan Endpoints
  - name: room-availability
    description: Room Availability Endpoints
paths:
  /metadata/classes:
    get:
      tags:
        - metadata
      summary: Returns list of all classes
      responses:
        '200':
          description: A list of classes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SchoolClass'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/subjects:
    get:
      tags:
        - metadata
      summary: Returns a list of all subjects
      responses:
        '200':
          description: A list of subjects
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Subject'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/rooms:
    get:
      tags:
        - metadata
      summary: Returns list of all rooms
      responses:
        '200':
          description: A list of rooms
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Room'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/teachers:
    get:
      tags:
        - metadata
      summary: Returns list of all teachers
      responses:
        '200':
          description: A list of teachers
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Teacher'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/dates:
    get:
      tags:
        - metadata
      summary: Returns all dates with status
      responses:
        '200':
          description: A list of dates with status
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DateStatus'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/dates/next-school-day:
    get:
      tags:
        - metadata
      summary: Returns the date of the next valid school day
      description: >-
        Returns the date of the next valid school day (skipping weekends and
        holidays)
      responses:
        '200':
          description: Next school day date
          content:
            application/json:
              schema:
                type: string
                format: date
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/available-dates:
    get:
      tags:
        - metadata
      summary: Returns date range for which timetable data is available
      responses:
        '200':
          description: Available dates
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  format: date
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/latest-date:
    get:
      tags:
        - metadata
      summary: Returns the latest date for which timetable data is available
      responses:
        '200':
          description: Latest available date
          content:
            application/json:
              schema:
                type: string
                format: date
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/holidays:
    get:
      tags:
        - metadata
      summary: Returns all holidays with dates
      responses:
        '200':
          description: A list of holidays
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Holiday'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/periods:
    get:
      tags:
        - metadata
      summary: Returns all periods with times
      responses:
        '200':
          description: A list of periods
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Period'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/current-period:
    get:
      tags:
        - metadata
      summary: Returns the current active lesson period based on server time
      responses:
        '200':
          description: Current active lesson period
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Period'
        '404':
          description: No active period at current time
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /metadata/current-period/{timestamp}:
    parameters:
      - $ref: '#/components/parameters/TimestampPath'
    get:
      tags:
        - metadata
      summary: Returns the current active lesson period based on provided timestamp
      responses:
        '200':
          description: Current active lesson period
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Period'
        '400':
          description: Invalid timestamp format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: No active period at specified time
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/{date}/classes/changes:
    parameters:
      - $ref: '#/components/parameters/DatePath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable changes for a specific date grouped by class
      responses:
        '200':
          description: Timetable changes for the specified date grouped by class
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid date format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/{date}/classes:
    parameters:
      - $ref: '#/components/parameters/DatePath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable for a specific date and all classes
      responses:
        '200':
          description: Timetable for all classes on the specified date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid date format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/{date}/classes/{id}:
    parameters:
      - $ref: '#/components/parameters/DatePath'
      - $ref: '#/components/parameters/ClassIdPath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable for a specific date and class
      responses:
        '200':
          description: Timetable for the specified class on the specified date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid date or class ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Class not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/today/classes/changes:
    get:
      tags:
        - plan-daily
      summary: Returns timetable changes for today grouped by class
      responses:
        '200':
          description: Timetable changes for today grouped by class
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/today/classes:
    get:
      tags:
        - plan-daily
      summary: Returns timetable for today and all classes
      responses:
        '200':
          description: Timetable for all classes for today
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/today/classes/{id}:
    parameters:
      - $ref: '#/components/parameters/ClassIdPath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable for today and a specific class
      responses:
        '200':
          description: Timetable for the specified class for today
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid class ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Class not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/{date}/teachers/changes:
    parameters:
      - $ref: '#/components/parameters/DatePath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable changes for a specific date grouped by teacher
      responses:
        '200':
          description: Timetable changes for the specified date grouped by teacher
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid date format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/{date}/teachers:
    parameters:
      - $ref: '#/components/parameters/DatePath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable for a specific date and all teachers
      responses:
        '200':
          description: Timetable for all teachers on the specified date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid date format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/{date}/teachers/{id}:
    parameters:
      - $ref: '#/components/parameters/DatePath'
      - $ref: '#/components/parameters/TeacherIdPath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable for a specific date and teacher
      responses:
        '200':
          description: Timetable for the specified teacher on the specified date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid date or teacher ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Teacher not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/today/teachers/changes:
    get:
      tags:
        - plan-daily
      summary: Returns timetable changes for today grouped by teacher
      responses:
        '200':
          description: Timetable changes for today grouped by teacher
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/today/teachers:
    get:
      tags:
        - plan-daily
      summary: Returns timetable for today and all teachers
      responses:
        '200':
          description: Timetable for all teachers for today
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/today/teachers/{id}:
    parameters:
      - $ref: '#/components/parameters/TeacherIdPath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable for today and a specific teacher
      responses:
        '200':
          description: Timetable for the specified teacher for today
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid teacher ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Teacher not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/{date}/rooms/changes:
    parameters:
      - $ref: '#/components/parameters/DatePath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable changes for a specific date grouped by room
      responses:
        '200':
          description: Timetable changes for the specified date grouped by room
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid date format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/{date}/rooms:
    parameters:
      - $ref: '#/components/parameters/DatePath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable for a specific date and all rooms
      responses:
        '200':
          description: Timetable for all rooms on the specified date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid date format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/{date}/rooms/{id}:
    parameters:
      - $ref: '#/components/parameters/DatePath'
      - $ref: '#/components/parameters/RoomIdPath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable for a specific date and room
      responses:
        '200':
          description: Timetable for the specified room on the specified date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid date or room ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Room not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/today/rooms/changes:
    get:
      tags:
        - plan-daily
      summary: Returns timetable changes for today grouped by room
      responses:
        '200':
          description: Timetable changes for today grouped by room
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/today/rooms:
    get:
      tags:
        - plan-daily
      summary: Returns timetable for today and all rooms
      responses:
        '200':
          description: Timetable for all rooms for today
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/daily/today/rooms/{id}:
    parameters:
      - $ref: '#/components/parameters/RoomIdPath'
    get:
      tags:
        - plan-daily
      summary: Returns timetable for today and a specific room
      responses:
        '200':
          description: Timetable for the specified room for today
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlanResponse'
        '400':
          description: Invalid room ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Room not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/{date}/classes:
    parameters:
      - $ref: '#/components/parameters/WeekDatePath'
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for a week and all classes
      responses:
        '200':
          description: Weekly timetable for all classes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '400':
          description: Invalid date format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/{date}/classes/{id}:
    parameters:
      - $ref: '#/components/parameters/WeekDatePath'
      - $ref: '#/components/parameters/ClassIdPath'
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for a week and class
      responses:
        '200':
          description: Weekly timetable for the specified class
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '400':
          description: Invalid date or class ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Class not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/today/classes:
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for this week and all classes
      responses:
        '200':
          description: Weekly timetable for all classes for this week
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/today/classes/{id}:
    parameters:
      - $ref: '#/components/parameters/ClassIdPath'
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for this week and class
      responses:
        '200':
          description: Weekly timetable for the specified class
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '400':
          description: Invalid class ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Class not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/{date}/teachers:
    parameters:
      - $ref: '#/components/parameters/WeekDatePath'
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for a week and all teachers
      responses:
        '200':
          description: Weekly timetable for all teachers
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '400':
          description: Invalid date format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/{date}/teachers/{id}:
    parameters:
      - $ref: '#/components/parameters/WeekDatePath'
      - $ref: '#/components/parameters/TeacherIdPath'
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for a week and teacher
      responses:
        '200':
          description: Weekly timetable for the specified teacher
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '400':
          description: Invalid date or teacher ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Teacher not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/today/teachers:
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for this week and all teachers
      responses:
        '200':
          description: Weekly timetable for all teachers
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/today/teachers/{id}:
    parameters:
      - $ref: '#/components/parameters/TeacherIdPath'
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for this week and teacher
      responses:
        '200':
          description: Weekly timetable for the specified teacher
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '400':
          description: Invalid teacher ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Teacher not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/{date}/rooms:
    parameters:
      - $ref: '#/components/parameters/WeekDatePath'
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for a week and all rooms
      responses:
        '200':
          description: Weekly timetable for all rooms
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '400':
          description: Invalid date format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/{date}/rooms/{id}:
    parameters:
      - $ref: '#/components/parameters/WeekDatePath'
      - $ref: '#/components/parameters/RoomIdPath'
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for a week and room
      responses:
        '200':
          description: Weekly timetable for the specified room
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '400':
          description: Invalid date or room ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Room not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/today/rooms:
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for this week and all rooms
      responses:
        '200':
          description: Weekly timetable for all rooms
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /plans/weekly/today/rooms/{id}:
    parameters:
      - $ref: '#/components/parameters/RoomIdPath'
    get:
      tags:
        - plan-weekly
      summary: Returns timetable for this week and room
      responses:
        '200':
          description: Weekly timetable for the specified room
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeeklyPlanResponse'
        '400':
          description: Invalid room ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Room not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /availability/today/rooms:
    get:
      tags:
        - room-availability
      summary: Returns availability of all rooms for today
      responses:
        '200':
          description: Room availability for today
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RoomAvailability'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /availability/today/rooms/{id}:
    parameters:
      - $ref: '#/components/parameters/RoomIdPath'
    get:
      tags:
        - room-availability
      summary: Returns availability of a specific room for today
      responses:
        '200':
          description: Room availability for the specified room today
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoomAvailability'
        '400':
          description: Invalid room ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Room not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /availability/{date}/rooms:
    parameters:
      - $ref: '#/components/parameters/DatePath'
    get:
      tags:
        - room-availability
      summary: Returns availability of all rooms for a specific date
      responses:
        '200':
          description: Room availability for the specified date
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RoomAvailability'
        '400':
          description: Invalid date format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /availability/{date}/rooms/{id}:
    parameters:
      - $ref: '#/components/parameters/DatePath'
      - $ref: '#/components/parameters/RoomIdPath'
    get:
      tags:
        - room-availability
      summary: Returns availability of a specific room for a specific date
      responses:
        '200':
          description: Room availability for the specified room and date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoomAvailability'
        '400':
          description: Invalid date or room ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Room not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
components:
  parameters:
    DatePath:
      name: date
      description: Date for requested timetable
      in: path
      required: true
      schema:
        type: string
        format: date
      example: '2025-01-15'
    WeekDatePath:
      name: date
      description: Date that is inside requested week timetable
      in: path
      required: true
      schema:
        type: string
        format: date
      example: '2025-01-15'
    ClassIdPath:
      name: id
      description: ID of a specific class
      in: path
      required: true
      schema:
        type: integer
      example: 12
    TeacherIdPath:
      name: id
      description: ID of a specific teacher
      in: path
      required: true
      schema:
        type: integer
      example: 101
    RoomIdPath:
      name: id
      description: ID of a specific room
      in: path
      required: true
      schema:
        type: integer
      example: 50
    TimestampPath:
      name: timestamp
      description: Timestamp to check for active lesson period without timezone info
      in: path
      required: true
      schema:
        type: string
        format: date-time
      example: '2023-10-05T10:15:00'
  schemas:
    Teacher:
      type: object
      required:
        - id
        - shortName
      properties:
        id:
          type: integer
          examples:
            - 101
        shortName:
          type: string
          description: Unique initials or short code of the teacher
          examples:
            - SMI
    Room:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: integer
          examples:
            - 50
        name:
          type: string
          description: Room number or name
          examples:
            - '3.12'
        level:
          type: string
          description: Floor level of the room
          examples:
            - '3. OG'
            - 'Basement'
            - '4'
        building:
          type: object
          properties:
            id:
              type: integer
              examples:
                - 2
            name:
              type: string
              examples:
                - Main Building
            address:
              type: string
              examples:
                - 'Schulstra√üe 1, 12345 Musterstadt'
    SchoolClass:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: integer
          examples:
            - 12
        name:
          type: string
          description: Grade and identifier
          examples:
            - 10A
    Subject:
      type: object
      required:
        - id
        - shortName
      properties:
        id:
          type: integer
          examples:
            - 5
        shortName:
          type: string
          examples:
            - MA
        longName:
          type: string
          examples:
            - Mathematics
    Period:
      type: object
      required:
        - number
        - startTime
        - endTime
      properties:
        id:
          type: integer
          examples:
            - 3
        number:
          type: integer
          description: The lesson number
          examples:
            - 1
        startTime:
          type: string
          pattern: ^([01]\d|2[0-3]):?([0-5]\d)$
          examples:
            - '08:00'
        endTime:
          type: string
          pattern: ^([01]\d|2[0-3]):?([0-5]\d)$
          examples:
            - '08:45'
    Holiday:
      type: object
      required:
        - name
        - startDate
        - endDate
      properties:
        id:
          type: integer
          examples:
            - 1
        name:
          type: string
          description: Name of the holiday
          examples:
            - Christmas Break
        startDate:
          type: string
          format: date
          description: Start date of the holiday
          examples:
            - '2025-12-23'
        endDate:
          type: string
          format: date
          description: End date of the holiday
          examples:
            - '2026-01-06'
    TimetableEntry:
      type: object
      required:
        - id
        - date
        - period
        - status
      properties:
        id:
          type: integer
        date:
          type: string
          format: date
        period:
          $ref: '#/components/schemas/Period'
        subject:
          $ref: '#/components/schemas/Subject'
        teacher:
          $ref: '#/components/schemas/Teacher'
        room:
          $ref: '#/components/schemas/Room'
        class:
          $ref: '#/components/schemas/SchoolClass'
        status:
          type: string
          description: Current state of the lesson
          enum:
            - scheduled
            - substituted
            - cancelled
            - cancelled_held_early
            - teacher_change
            - subject_change
            - room_change
            - time_change
        substitutionInfo:
          type: object
          description: Details if the lesson is not 'scheduled'
          properties:
            originalTeacher:
              $ref: '#/components/schemas/Teacher'
            originalRoom:
              $ref: '#/components/schemas/Room'
            changeReason:
              type: string
              examples:
                - Illness
            notes:
              type: string
              examples:
                - Work on textbook page 45
    RoomAvailability:
      type: object
      required:
        - room
        - date
        - periods
      properties:
        room:
          $ref: '#/components/schemas/Room'
        date:
          type: string
          format: date
          description: The date for which availability is shown
        periods:
          type: array
          description: List of periods with availability status
          items:
            type: object
            required:
              - period
              - isAvailable
            properties:
              period:
                $ref: '#/components/schemas/Period'
              isAvailable:
                type: boolean
                description: Whether the room is available during this period
    PlanResponse:
      type: object
      required:
        - generatedAt
        - entries
      properties:
        generatedAt:
          type: string
          format: date-time
          description: Timestamp when the response was generated
        entries:
          description: Timetable entries grouped by entity ID (class, teacher, or room)
          type: object
          additionalProperties:
            description: List of timetable entries for the specific entity (class, teacher, or room)
            type: array
            items:
              $ref: '#/components/schemas/TimetableEntry'
    WeeklyPlanResponse:
      type: object
      required:
        - generatedAt
        - entries
      properties:
        generatedAt:
          type: string
          format: date-time
          description: Timestamp when the response was generated
        entries:
          description: Timetable entries grouped by day
          type: object
          additionalProperties:
            description: List of timetable grouped by specific entity (class, teacher, or room)
            type: object
            additionalProperties:
              description: List of timetable entries for the specific day and entity (class, teacher, or room)
              type: array
              items:
                $ref: '#/components/schemas/TimetableEntry'
    DateStatus:
      type: object
      required:
        - date
        - status
      properties:
        date:
          type: string
          format: date
          description: The calendar date
          examples:
            - '2025-01-15'
        status:
          type: string
          description: Status of the date
          enum:
            - school_day
            - weekend
            - holiday
          examples:
            - school_day
    Error:
      type: object
      required:
        - message
      properties:
        message:
          type: string
          description: Human-readable error message
          examples:
            - Invalid date format. Expected YYYY-MM-DD.
        code:
          type: string
          description: Machine-readable error code
          examples:
            - INVALID_DATE_FORMAT
